{% load mongo_debug_tags %}

<style type="text/css">
pre.mongo-highlight, pre.mongo-highlight span {
    font-family: 'Consolas', 'Deja Vu Sans Mono', 'Bitstream Vera Sans Mono', 'Monaco', 'Courier New', monospace !important;
    font-size: 1.05em !important;
}
</style>

<h4>Queries</h4>
{% if queries %}
<table>
    <thead>
        <tr>
            <th>Time (ms)</th>
            <th>Operation</th>
            <th>Collection</th>
            <th>Query</th>
            <th>Ordering</th>
            <th>Skip</th>
            <th>Limit</th>
        </tr>
    </thead>
    <tbody>
        {% for query in queries %}
            <tr class="{% cycle 'djDebugOdd' 'djDebugEven' %}">
                <td>{{ query.time|floatformat:"4" }}</td>
                <td>{{ query.operation|title }}</td>
                <td>{{ query.collection }}</td>
                <td>
                    {% if query.query %}
                    <pre class="mongo-highlight">{{ query.query|format_dict|highlight_json|safe }}</pre>
                  {% endif %}
                </td>
                <td><pre class="mongo-highlight">{% if query.ordering %}{{ query.ordering }}{% endif %}</pre></td>
                <td>{% if query.skip %}{{ query.skip }}{% endif %}</td>
                <td>{% if query.limit %}{{ query.limit }}{% endif %}</td>
            </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>No queries recorded</p>
{% endif %}

<h4>Inserts</h4>
{% if inserts %}
<table>
    <thead>
        <tr>
            <th>Time (ms)</th>
            <th>Document</th>
            <th>Safe</th>
        </tr>
    </thead>
    <tbody>
        {% for insert in inserts %}
            <tr class="{% cycle 'djDebugOdd' 'djDebugEven' %}">
                <td>{{ insert.time|floatformat:"4" }}</td>
                <td>
                    <pre class="mongo-highlight">{{ insert.document|format_dict:120|highlight_json|safe }}</pre>
                </td>
                <td>{{ insert.safe }}</td>
            </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>No inserts recorded</p>
{% endif %}

<h4>Removes</h4>
{% if removes %}
<table>
    <thead>
        <tr>
            <th>Time (ms)</th>
            <th>Query / Id</th>
            <th>Safe</th>
        </tr>
    </thead>
    <tbody>
        {% for remove in removes %}
            <tr class="{% cycle 'djDebugOdd' 'djDebugEven' %}">
                <td>{{ remove.time|floatformat:"4" }}</td>
                <td>
                    <pre class="mongo-highlight">{{ remove.spec_or_id|format_dict:120|highlight_json|safe }}</pre>
                </td>
                <td>{{ remove.safe }}</td>
            </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>No removes recorded</p>
{% endif %}

<h4>Updates</h4>
{% if updates %}
<table>
    <thead>
        <tr>
            <th>Time (ms)</th>
            <th>Query</th>
            <th>Update</th>
            <th>Safe</th>
            <th>Multi</th>
            <th>Upsert</th>
        </tr>
    </thead>
    <tbody>
        {% for update in updates %}
            <tr class="{% cycle 'djDebugOdd' 'djDebugEven' %}">
                <td>{{ update.time|floatformat:"4" }}</td>
                <td>
                    <pre class="mongo-highlight">{{ update.spec|format_dict:120|highlight_json|safe }}</pre>
                </td>
                <td>
                    <pre class="mongo-highlight">{{ update.document|format_dict:120|highlight_json|safe }}</pre>
                </td>
                <td>{{ update.safe }}</td>
                <td>{{ update.multi }}</td>
                <td>{{ update.upsert }}</td>
            </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>No updates recorded</p>
{% endif %}

